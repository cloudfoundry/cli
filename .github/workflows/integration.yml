name: Integration Tests

on:
  workflow_dispatch:
  # workflow_run:
  #   workflows: 
  #     - Package CLI
  #   types: 
  #     - completed

permissions:
  contents: read

jobs: 
  run-integration-tests-cf-env-with-edge-capi:
    name: Integration tests with EDGE CAPI
    uses: ./.github/workflows/integration-tests-new.yml
    with:
      environment: PROD
      capi-version: edge
      go-version: "1.20"
      run-with-client-creds: false
      os: ubuntu-latest
    secrets: inherit

  run-integration-tests-cf-env-with-edge-capi-with-client-creds:
    name: EDGE CAPI and client creds
    uses: ./.github/workflows/integration-tests-new.yml
    with:
      environment: PROD
      capi-version: edge
      go-version: "1.20"
      run-with-client-creds: true
      os: ubuntu-latest
    secrets: inherit

  run-integration-tests-cf-env-with-min-capi:
    name: MIN CAPI
    uses: ./.github/workflows/integration-tests-new.yml
    with:
      environment: PROD
      capi-version: v16.11.0
      go-version: "1.20"
      run-with-client-creds: false
      os: ubuntu-latest
    secrets: inherit

  run-integration-windows:
    name: Windows
    uses: ./.github/workflows/integration-tests-new.yml
    with:
      environment: PROD
      capi-version: edge
      go-version: "1.20"
      run-with-client-creds: false
      os: windows-latest
    secrets: inherit

  run-integration-windows-client-credentials:
    name: Windows with client credentials
    uses: ./.github/workflows/integration-tests-new.yml
    with:
      environment: PROD
      capi-version: edge
      go-version: "1.20"
      run-with-client-creds: true
      os: windows-latest
    secrets: inherit
